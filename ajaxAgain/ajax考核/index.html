<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <div class="box">
        <!-- æ ‡é¢˜ -->
        <h1>å¤©æ°”é¢„æŠ¥</h1>

        <!-- æœç´¢å±‚ -->
        <div class="search_box">
            <input type="seach" class="search_input" placeholder="è¯·è¾“å…¥åŸå¸‚åç§°"/>
            <span class="search_btn">æœç´¢</span>
        </div>

        <!-- æœç´¢çƒ­è¯ -->
        <nav class="hot_words">
            <span class="title">çƒ­é—¨åŸå¸‚:</span>
            <ul>
                <li>å¹¿å·</li>
                <li>åŒ—äº¬</li>
                <li>ä¸Šæµ·</li>
                <li>æ·±åœ³</li>
                <li>è‹å·</li>
                <li>å¤§è¿</li>
                <li>é‡åº†</li>
            </ul>
            <span class="changeIcon">æ¢ä¸€æ¢
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-counterclockwise" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 3a5 5 0 1 1-4.546 2.914.5.5 0 0 0-.908-.417A6 6 0 1 0 8 2v1z"/>
                    <path d="M8 4.466V.534a.25.25 0 0 0-.41-.192L5.23 2.308a.25.25 0 0 0 0 .384l2.36 1.966A.25.25 0 0 0 8 4.466z"/>
                </svg>
            </span>
        </nav>

        <!-- å†…å®¹å±‚ -->
        <div class="content">
            <ul>
                <li>
                    <img src="images/yu.png" height="40"/>
                    <p class="title">æ™´</p>
                    <p class="desc">æœ€ä½æ¸© -17Â°c ~ æœ€é«˜æ¸© -11Â°C</p>
                    <p class="day_week">6æ—¥æ˜ŸæœŸä¸‰</p>
                    <p>åŒ—é£</p>
                    <p>3çº§</p>
                </li>
                <li>
                    <img src="images/yu.png" height="40"/>
                    <p class="title">æ™´</p>
                    <p class="desc">æœ€ä½æ¸© -17Â°c ~ æœ€é«˜æ¸© -11Â°C</p>
                    <p class="day_week">6æ—¥æ˜ŸæœŸä¸‰</p>
                    <p>åŒ—é£</p>
                    <p>3çº§</p>
                </li>
                <li>
                    <img src="images/yu.png" height="40"/>
                    <p class="title">æ™´</p>
                    <p class="desc">æœ€ä½æ¸© -17Â°c ~ æœ€é«˜æ¸© -11Â°C</p>
                    <p class="day_week">6æ—¥æ˜ŸæœŸä¸‰</p>
                    <p>åŒ—é£</p>
                    <p>3çº§</p>
                </li>
                <li>
                    <img src="images/yu.png" height="40"/>
                    <p class="title">æ™´</p>
                    <p class="desc">æœ€ä½æ¸© -17Â°c ~ æœ€é«˜æ¸© -11Â°C</p>
                    <p class="day_week">6æ—¥æ˜ŸæœŸä¸‰</p>
                    <p>åŒ—é£</p>
                    <p>3çº§</p>
                </li>
                <li>
                    <img src="images/yu.png" height="40"/>
                    <p class="title">æ™´</p>
                    <p class="desc">æœ€ä½æ¸© -17Â°c ~ æœ€é«˜æ¸© -11Â°C</p>
                    <p class="day_week">6æ—¥æ˜ŸæœŸä¸‰</p>
                    <p>åŒ—é£</p>
                    <p>3çº§</p>
                </li>
                <li>
                    <img src="images/yu.png" height="40"/>
                    <p class="title">æ™´</p>
                    <p class="desc">æœ€ä½æ¸© -17Â°c ~ æœ€é«˜æ¸© -11Â°C</p>
                    <p class="day_week">6æ—¥æ˜ŸæœŸä¸‰</p>
                    <p>åŒ—é£</p>
                    <p>3çº§</p>
                </li>
                <li>
                    <img src="images/yu.png" height="40"/>
                    <p class="title">æ™´</p>
                    <p class="desc">æœ€ä½æ¸© -17Â°c ~ æœ€é«˜æ¸© -11Â°C</p>
                    <p class="day_week">6æ—¥æ˜ŸæœŸä¸‰</p>
                    <p>åŒ—é£</p>
                    <p>3çº§</p>
                </li>
            </ul>
        </div>
    </div>

    <!-- å¼•å…¥jQuery -->
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        // ç‚¹å‡»æœç´¢æŒ‰é’®,æ ¹æ®æ–‡æœ¬æ¡†çš„å€¼æŸ¥è¯¢å¤©æ°”
        $(".search_btn").on("click",function(){
            // è·å–åŸå¸‚åç§°
            var cityNameVal = $(".search_input").val();
            // åˆ¤æ–­å€¼æ˜¯å¦ä¸ºç©º
            if( cityNameVal == "" ){
                alert("è¯·è¾“å…¥åŸå¸‚åç§°å†æœç´¢!");
                return;
            }
            // å‘é€ajaxè¯·æ±‚
            getDataByCityName( cityNameVal );
        });

        // å®šä¹‰æ ¹æ®åŸå¸‚åç§°è·å–å¤©æ°”æ•°æ®çš„å‡½æ•°
        function getDataByCityName( cityName ){
            $.get("http://api.tianapi.com/txapi/tianqi/index",{
                key:"efff0b9755cfa286b464161dd5d20294",
                city: cityName
            },function( res ){
                if( res.code != 200 ){
                    $(".content").html( "<p align='center' style='height:100px;line-height:100px;font-size:30px;color:red;'>ğŸ˜‚è·å–å¤©æ°”æ•°æ®å‘ç”Ÿäº†é”™è¯¯,é”™è¯¯åŸå› æ˜¯:"+res.msg + "<p>");
                    return ;
                }
                // è·å–ç›®æ ‡æ•°æ®
                var data = res.newslist;
                // æ ¹æ®æ•°æ®æ¸²æŸ“DOMç»“æ„
                renderData( data );
            })
        }

        // å®šä¹‰æ ¹æ®æ•°æ®æ¸²æŸ“DOMç»“æ„çš„å‡½æ•°
        function renderData( currentData ){
            var htmlStr = `<ul>`;
            $.each( currentData , function( index, item ){
                htmlStr += `
                <li>
                    <img src="images/${item.weatherimg}" height="40">
                    <p class="title">${item.weather}</p>
                    <p class="desc">æœ€ä½æ¸© ${item.lowest}Â°c ~ æœ€é«˜æ¸© ${item.highest}</p>
                    <p class="day_week">${item.date}${item.week}</p>
                    <p>${item.wind}</p>
                    <p>${item.windspeed}çº§</p>
                </li>
                `;
            });
            htmlStr += `</ul>`;
            $(".content").html( htmlStr );
        }

        // è®¾ç½®æ–‡æœ¬æ¡†çš„å€¼
        $(".search_input").val("å¹¿å·");
        // é»˜è®¤æ˜¾ç¤ºå¹¿å·åŸå¸‚çš„å¤©æ°”
        getDataByCityName( "å¹¿å·" );
        
        // çƒ­é—¨åŸå¸‚ç‚¹å‡»äº‹ä»¶
        $(".hot_words ul").on("click","li",function(){
            // è·å–åŸå¸‚åç§°
            var cityNameVal =  $(this).text();
            // è®¾ç½®æ–‡æœ¬æ¡†çš„å€¼
            $(".search_input").val( cityNameVal );
            // æ ¹æ®åŸå¸‚åç§°è·å–å¤©æ°”æ•°æ®
            getDataByCityName( cityNameVal );
        });

        // å®šä¹‰çƒ­é—¨åŸå¸‚æ•°ç»„
        // çƒ­é—¨åŸå¸‚æ€»åˆ—è¡¨
        var arrCityName = [
            "åŒ—äº¬",
            "ä¸Šæµ·",
            "å¹¿å·",
            "æ·±åœ³",
            "è‹å·",
            "å¤§è¿",
            "é‡åº†",
            "æ­å·",
            "æ— é”¡",
            "å¤©æ´¥",
            "ä½›å±±",
            "å®æ³¢",
            "å—äº¬",
            "æˆéƒ½",
            "ä¸œè",
            "æ­¦æ±‰",
            "é’å²›",
            "æ²ˆé˜³",
            "çƒŸå°",
            "å”å±±",
            "æµå—",
            "å“ˆå°”æ»¨",
            "çŸ³å®¶åº„",
            "éƒ‘å·",
            "æ³‰å·",
            "æ¸©å·",
            "é•¿æ²™",
            "å—é€š",
            "é•¿æ˜¥",
            "æ½åŠ",
            "ç»å…´",
            "ç¦å·",
            "æ·„åš",
            "å¤§åº†",
            "å¸¸å·",
            "å°å·",
            "æµå®",
            "ä¸œè¥",
            "è¥¿å®‰",
            "å¾å·",
            "ä¸´æ²‚",
            "å¨æµ·",
            "å˜‰å…´",
            "é‚¯éƒ¸",
            "æ´›é˜³",
            "æ²§å·",
            "é‡‘å",
            "æ˜†æ˜",
            "å—é˜³",
            "ä¿å®š"
        ];

        // ç‚¹å‡»æ¢ä¸€æ¢åˆ‡æ¢åŸå¸‚
        $(".changeIcon").on("click",function(){
            // éšæœºæ’åº
            arrCityName.sort(function(){
                return Math.random()-0.5;
            });
            // éšæœºä»æ•°ç»„ä¸­å–å‡º7ä¸ªä¸é‡å¤çš„æ•°ç»„å…ƒç´ 
            var arrCity = arrCityName.slice(0,7);
            // éå†ç›®æ ‡åŸå¸‚æ•°ç»„arrCity
            var htmlStr = ``;
            $.each( arrCity , function( index, item ){
                htmlStr += `<li>${item}</li>`;
            });
            // è®¾ç½®çƒ­é—¨åŸå¸‚æ ‡ç­¾å†…å®¹
            $(".hot_words ul").html( htmlStr );
            // è®¾ç½®æ–‡æœ¬æ¡†çš„å€¼
            $(".search_input").val( arrCity[0] );
            // æ ¹æ®åŸå¸‚åç§°è·å–å¤©æ°”æ•°æ®
            getDataByCityName( arrCity[0] );
        })
    
        // ç»™æ–‡æœ¬ç»‘å®šé”®ç›˜å¼¹èµ·äº‹ä»¶
        $(".search_input").keyup(function( e ){
            if( e.keyCode == 13 ){
                $(".search_btn").click();
            }
        })
    </script>
</body>
</html>